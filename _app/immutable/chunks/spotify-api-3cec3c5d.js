import{S as p,i as m,s as y,k as g,q as d,l as w,m as k,r as _,h as c,n as P,b as T,G as b,M as S,B as o,N as I,O as C}from"./index-6622727b.js";import{w as h}from"./index-66740994.js";function $(e){let t,s,n,a;return{c(){t=g("button"),s=d("Login with Spotify"),this.h()},l(i){t=w(i,"BUTTON",{class:!0});var r=k(t);s=_(r,"Login with Spotify"),r.forEach(c),this.h()},h(){P(t,"class","bg-green-600 text-white rounded-full px-5 py-3")},m(i,r){T(i,t,r),b(t,s),n||(a=S(t,"click",function(){I(e[0])&&e[0].apply(this,arguments)}),n=!0)},p(i,[r]){e=i},i:o,o,d(i){i&&c(t),n=!1,a()}}}function v(e,t,s){let{onClick:n}=t;return e.$$set=a=>{"onClick"in a&&s(0,n=a.onClick)},[n]}class M extends p{constructor(t){super(),m(this,t,v,$,y,{onClick:0})}}const x=h(),U=h(),A="a66d952188de470d9380ff896215a670";function q(){const e=new URLSearchParams;e.set("response_type","token"),e.set("client_id",A),e.set("scope","playlist-read-private"),e.set("redirect_uri",`${window.location.origin}/callback`),window.location.href="https://accounts.spotify.com/authorize?"+e.toString()}async function l(e,t){const s={...t,headers:{"Content-Type":"application/json",Authorization:"Bearer "+C(x),...t==null?void 0:t.headers}};return fetch("https://api.spotify.com/v1"+e,s)}async function z(){const e=await l("/me");if(e.ok)return e.json()}async function E(e={}){const t=[],s=await f(),n=Math.ceil(parseInt(s.total)/parseInt(s.limit));t.push(...s.items);for(let a=1;a<n;a++){const i=await f({page:a});t.push(...i.items)}return e.filter?t.filter(a=>{var i;return a.owner.id===((i=e.filter)==null?void 0:i.ownerId)}):t}async function f(e={}){let t=0;e.offset?t=e.offset:e.page&&(t=e.page*(e.limit??50));const s=await l(`/me/playlists?limit=${e.limit??50}&offset=${t}`);if(s.ok)return s.json()}async function u(e,t={}){let s=0;t.offset?s=t.offset:t.page&&(s=t.page*(t.limit??0));const n=await l(`/playlists/${e}/tracks?limit=${t.limit??50}&offset=${s}`);if(n.ok)return n.json()}async function L(e){const t=[],s=await u(e),n=Math.ceil(parseInt(s.total)/parseInt(s.limit));t.push(...s.items);for(let a=1;a<n;a++){const i=await u(e,{page:a});t.push(...i.items)}return t}async function N(e){return Promise.all(e.map(async t=>{const s=await L(t.id);return{...t,tracks:s}}))}export{M as L,x as a,z as b,E as c,N as d,U as e,f as g,q as l};
